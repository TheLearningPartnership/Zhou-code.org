

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5.3 Predicting Assessment Performance &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/jupyter_execute/final_andancedanalysis_assesspredict';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to the Code.Org Analysis Report
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Dataset Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../datasetintro.html">2. Overview of Datasets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Descriptive Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../final_teacheranalysis.html">Teacher-Centric Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../final_teacheranalysis1.html">3. Teacher-Centric Descriptive Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../final_studentanalysis.html">Student-Centric Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../final_studentanalysis_activity1.html">4.1 Activity Performance Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final_studentanalysis_activity2.html">4.1 Rention and Drop-Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final_studentanalysis_assessment1.html">4.3 Assessment Analysis</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Exploratory Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../final_advancedanalysis.html">Learning Analytics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../final_advancedanalysis_activity1.html">5.1 Analysis of Teacher Platform Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final_advancedanalysis_studentprofile.html">5.2 Investigation of Student Learning Behaviors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final_advancedanalysis_assesspredict.html">5.3 Predictive Modeling of Assessment Performance</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=lab/tree/docs/docs/jupyter_execute/final_andancedanalysis_assesspredict.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/executablebooks/jupyter-book&urlpath=lab/tree/jupyter-book/docs/docs/jupyter_execute/final_andancedanalysis_assesspredict.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdocs/jupyter_execute/final_andancedanalysis_assesspredict.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/jupyter_execute/final_andancedanalysis_assesspredict.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5.3 Predicting Assessment Performance</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teacher-implementation-level-clustering">Teacher Implementation Level Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-type-and-teacher-experience-features">Question Type and Teacher Experience Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#student-learning-behavior-features">Student Learning Behavior Features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-training-and-evaluation">Model Training and Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-performance">Model Performance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-analysis">Feature Importance Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-plots">Feature Importance Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-gradient-boosting-importance-shap">Visualizing Gradient Boosting Importance: SHAP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-svm-importance-partial-dependence-plots">Visualizing SVM Importance: Partial Dependence Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights:</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span><span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">permutation_importance</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">shap</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/rachel/Library/CloudStorage/Dropbox-TLPSummerInterns/TLP Summer Intern Folder/Zhou/CODE - MPS_data_july_2023/mps_student_activity.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">on_bad_lines</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">)</span>
<span class="n">data_detail</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/rachel/Library/CloudStorage/Dropbox-TLPSummerInterns/TLP Summer Intern Folder/Zhou/CODE - MPS_data_july_2023/mps_student_activity_detail.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">on_bad_lines</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">)</span>
<span class="n">data_assessment</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/rachel/Library/CloudStorage/Dropbox-TLPSummerInterns/TLP Summer Intern Folder/Zhou/CODE - MPS_data_july_2023/mps_assessments.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">on_bad_lines</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">)</span>
<span class="n">data_assessment</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_assessment</span><span class="p">[</span><span class="s1">&#39;script_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="predicting-assessment-performance">
<h1>5.3 Predicting Assessment Performance<a class="headerlink" href="#predicting-assessment-performance" title="Permalink to this heading">#</a></h1>
<ol class="arabic simple">
<li><p><strong>Feature Engineering</strong>: Created new features <code class="docutils literal notranslate"><span class="pre">implementation_level</span></code>, <code class="docutils literal notranslate"><span class="pre">first_year_of_teaching</span></code>, <code class="docutils literal notranslate"><span class="pre">child_level_type</span></code>, and learning profile labels.</p></li>
<li><p><strong>Model Training and Evaluation</strong>: Leveraged linear regression and machine learning techniqes to predict student assessment scores. Calculated the MSE and R-sQUARED to evaluate the performance of the model.</p></li>
<li><p><strong>Feature Importance Analysis</strong>: Interpreted the feature importance of the models to understand the relationship between the predictors and the target variable.</p></li>
</ol>
<section id="feature-engineering">
<h2>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Permalink to this heading">#</a></h2>
<p>Three features were generated from the raw data:</p>
<p><code class="code docutils literal notranslate"><span class="pre">implementation_level</span></code>: Categorized teachers into 3 levels (low, medium, high) based on their cumulative activity over time using K-Means clustering. This helps differentiate teachers based on their experience levels.</p>
<p><code class="code docutils literal notranslate"><span class="pre">first_year_of_teaching</span></code>: Indicated whether a teacher is teaching a particular course for the first time. This captures how teacher proficiency changes over time.</p>
<p><code class="code docutils literal notranslate"><span class="pre">child_level_type</span></code>: Rpepresented the quiz item type, can be Multi (single-select multi choice), Multi2 (choose-two multi-choice), and Match (matching items)</p>
<section id="teacher-implementation-level-clustering">
<h3>Teacher Implementation Level Clustering<a class="headerlink" href="#teacher-implementation-level-clustering" title="Permalink to this heading">#</a></h3>
<p>This <code class="code docutils literal notranslate"><span class="pre">cluster_teachers_by_implementation</span></code> function processes data from activity dataset to categorize teachers based on their cumulative implementation levels over various school years.</p>
<p>The implementation levels are determined by metrics such as the cumulative unique number of scripts assigned and the cumulative unique number of students they’ve interacted with up to a particular school year.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_cumulative_unique</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">cumulative_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series</span><span class="p">:</span>
        <span class="n">seen</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">cumulative_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seen</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">cumulative_list</span>

<span class="k">def</span> <span class="nf">cluster_teachers_by_implementation</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Step 1: Preprocess the Data</span>
    <span class="n">data_sorted</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">])</span>

    <span class="c1"># Step 2: Compute cumulative unique values for scripts and students</span>
    <span class="n">cumulative_data</span> <span class="o">=</span> <span class="n">data_sorted</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;script_id&#39;</span><span class="p">:</span> <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;student_user_id&#39;</span><span class="p">:</span> <span class="s1">&#39;unique&#39;</span>
    <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">cumulative_data</span><span class="p">[</span><span class="s1">&#39;cumulative_scripts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cumulative_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">)[</span><span class="s1">&#39;script_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">compute_cumulative_unique</span><span class="p">)</span>
    <span class="n">cumulative_data</span><span class="p">[</span><span class="s1">&#39;cumulative_students&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cumulative_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">)[</span><span class="s1">&#39;student_user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">compute_cumulative_unique</span><span class="p">)</span>

    <span class="c1"># Step 3: Scale the Metrics</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">cumulative_data</span><span class="p">[[</span><span class="s1">&#39;cumulative_scripts&#39;</span><span class="p">,</span> <span class="s1">&#39;cumulative_students&#39;</span><span class="p">]])</span>

    <span class="c1"># Step 4: Apply KMeans Clustering</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;k-means++&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">cumulative_data</span><span class="p">[</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span>

    <span class="c1"># Step 5: Convert cluster IDs to labels</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">}</span>
    <span class="n">cumulative_data</span><span class="p">[</span><span class="s1">&#39;implementation_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cumulative_data</span><span class="p">[</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cluster_labels</span><span class="p">)</span>
    <span class="n">cluster_membership_df</span> <span class="o">=</span> <span class="n">cumulative_data</span><span class="p">[[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">,</span> <span class="s1">&#39;implementation_level&#39;</span><span class="p">]]</span>
    <span class="n">cluster_membership_df</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cluster_membership_df</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">cluster_membership_df</span>

<span class="n">implementation</span> <span class="o">=</span> <span class="n">cluster_teachers_by_implementation</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_assessment</span><span class="p">,</span> <span class="n">implementation</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="question-type-and-teacher-experience-features">
<h3>Question Type and Teacher Experience Features<a class="headerlink" href="#question-type-and-teacher-experience-features" title="Permalink to this heading">#</a></h3>
<p>Previous descriptive analysis on assessment dataset has shown that correctness vary on course and question type, so here we extracted the feature <code class="code docutils literal notranslate"><span class="pre">child_level_type</span></code> to control for its impact.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difficulty coefficient for each course and parent level</span>
<span class="n">difficulty_coefficients</span> <span class="o">=</span> <span class="n">data_assessment</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;course_name&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span><span class="s1">&#39;child_level_type&#39;</span><span class="p">])[</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">difficulty_coefficients</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;course_name&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span><span class="s1">&#39;child_level_type&#39;</span><span class="p">,</span> <span class="s1">&#39;difficulty_coefficient&#39;</span><span class="p">]</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">difficulty_coefficients</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;course_name&#39;</span><span class="p">,</span><span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span><span class="s1">&#39;child_level_type&#39;</span><span class="p">,],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the first year each teacher taught this course</span>
<span class="n">first_year_taught</span> <span class="o">=</span> <span class="n">df_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">)[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">first_year_taught</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;first_year_taught&#39;</span><span class="p">]</span>
<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">first_year_taught</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="c1"># Create a new column to indicate whether the current year is the first year the teacher taught this course</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;first_year_of_teaching&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;first_year_taught&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1">#1 represents is first year</span>

<span class="c1"># Replace &#39;Y&#39; and &#39;N&#39; in &#39;answer_correct_flag&#39; with 1 and 0 respectively</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="n">df_model</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span><span class="s1">&#39;course_name&#39;</span><span class="p">,</span><span class="s1">&#39;school_year&#39;</span><span class="p">,</span><span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span><span class="s1">&#39;child_level_type&#39;</span><span class="p">,</span><span class="s1">&#39;student_user_id&#39;</span><span class="p">,</span><span class="s1">&#39;implementation_level&#39;</span><span class="p">,</span><span class="s1">&#39;difficulty_coefficient&#39;</span><span class="p">,</span><span class="s1">&#39;first_year_of_teaching&#39;</span><span class="p">,</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]]</span>
<span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;difficulty_coefficient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;difficulty_coefficient&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="student-learning-behavior-features">
<h3>Student Learning Behavior Features<a class="headerlink" href="#student-learning-behavior-features" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculating the time gap between created_at and updated_at timestamps</span>
<span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span>
<span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;updated_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;updated_at&#39;</span><span class="p">])</span>
<span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;time_gap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;updated_at&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> 
<span class="c1"># Filtering the data based on the given criteria</span>
<span class="n">filtered_data</span> <span class="o">=</span> <span class="n">data_detail</span><span class="p">[(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                     <span class="p">(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;time_gap&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                     <span class="p">(</span><span class="n">data_detail</span><span class="p">[</span><span class="s1">&#39;time_gap&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">60</span><span class="o">*</span><span class="mi">15</span><span class="p">)]</span>

<span class="c1"># Categorizing the test results based on provided breakdown</span>
<span class="k">def</span> <span class="nf">categorize_test_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">result</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Failed&#39;</span>
    <span class="k">elif</span> <span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">result</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Pass (Not Optimal)&#39;</span>
    <span class="k">elif</span> <span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">result</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Optimal&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Special&#39;</span>

<span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;best_result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">categorize_test_result</span><span class="p">)</span>

<span class="c1"># Identify Learning Behaviors for the filtered data</span>
<span class="k">def</span> <span class="nf">assign_behavior_label</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Failed&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;One-shot Failures&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Failed&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Strugglers&quot;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Pass (Not Optimal)&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suboptimal Success&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Optimal&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Succeed at First Trial&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;time_gap&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Optimal&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Rapid Guessing&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;attempts&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;time_gap&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;test_result_category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Optimal&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Reflective Learner&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Others&quot;</span>
    
<span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;behavior_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_behavior_label</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Counting occurrences of each label</span>
<span class="n">behavior_counts</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="p">[</span><span class="s1">&#39;behavior_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># convert counts to proportion to standardize the data</span>
<span class="n">grouped_data</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;student_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">,</span> <span class="s1">&#39;behavior_label&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">grouped_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">grouped_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Standardizing the data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">grouped_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:])</span>
<span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;school_year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_model</span><span class="p">,</span> <span class="n">grouped_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;student_user_id&#39;</span><span class="p">,</span><span class="s1">&#39;school_year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">df_model</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>teacher_user_id</th>
      <th>course_name</th>
      <th>school_year</th>
      <th>parent_level_type</th>
      <th>child_level_type</th>
      <th>student_user_id</th>
      <th>implementation_level</th>
      <th>difficulty_coefficient</th>
      <th>first_year_of_teaching</th>
      <th>answer_correct_flag</th>
      <th>One-shot Failures</th>
      <th>Others</th>
      <th>Rapid Guessing</th>
      <th>Reflective Learner</th>
      <th>Strugglers</th>
      <th>Suboptimal Success</th>
      <th>Succeed at First Trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24529224</td>
      <td>csd</td>
      <td>2017</td>
      <td>Gamelab</td>
      <td>Multi</td>
      <td>33728229</td>
      <td>High</td>
      <td>0.64523</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.974118</td>
      <td>-0.507336</td>
      <td>0.084512</td>
      <td>-0.932389</td>
      <td>-0.423593</td>
      <td>-0.456561</td>
      <td>0.692087</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24529224</td>
      <td>csd</td>
      <td>2017</td>
      <td>Gamelab</td>
      <td>Multi</td>
      <td>33718947</td>
      <td>High</td>
      <td>0.64523</td>
      <td>1</td>
      <td>1.0</td>
      <td>-0.277267</td>
      <td>-0.486426</td>
      <td>-0.332095</td>
      <td>-0.994872</td>
      <td>0.679608</td>
      <td>-0.456561</td>
      <td>0.896996</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24529224</td>
      <td>csd</td>
      <td>2017</td>
      <td>Gamelab</td>
      <td>Multi</td>
      <td>29432841</td>
      <td>High</td>
      <td>0.64523</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.861267</td>
      <td>-0.176840</td>
      <td>0.382254</td>
      <td>-0.711923</td>
      <td>-0.465862</td>
      <td>-0.456561</td>
      <td>0.414940</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24529224</td>
      <td>csd</td>
      <td>2017</td>
      <td>Gamelab</td>
      <td>Multi</td>
      <td>33752236</td>
      <td>High</td>
      <td>0.64523</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.325929</td>
      <td>-0.025362</td>
      <td>-0.415028</td>
      <td>-0.860324</td>
      <td>-0.419108</td>
      <td>-0.456561</td>
      <td>0.780722</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24529224</td>
      <td>csd</td>
      <td>2017</td>
      <td>Gamelab</td>
      <td>Multi</td>
      <td>33752305</td>
      <td>High</td>
      <td>0.64523</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.341637</td>
      <td>0.066355</td>
      <td>-0.508779</td>
      <td>-0.879053</td>
      <td>-0.252751</td>
      <td>-0.456561</td>
      <td>0.706011</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="model-training-and-evaluation">
<h2>Model Training and Evaluation<a class="headerlink" href="#model-training-and-evaluation" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Split the data into training and testing sets.</p></li>
<li><p>Train Linear Regression, Random Forest, Gradient Boosting, and SVR models.</p></li>
<li><p>Evaluate the models on the test set using metrics like MAE, MS, RMSE and ROC AUC.</p></li>
</ol>
<section id="model-selection">
<h3>Model Selection<a class="headerlink" href="#model-selection" title="Permalink to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Characteristics</p></th>
<th class="head"><p>Reason to be Chosen in Our Dataset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Linear Regression</strong></p></td>
<td><p>Models the linear relationship between independent and dependent variables.</p></td>
<td><p><strong>Advantages</strong>: Simple and interpretable; Fast to train.<br><strong>Disadvantages</strong>: Assumes linear relationships; Sensitive to outliers.</p></td>
<td><p><strong>Why Chosen</strong>: Foundational algorithm for regression tasks.<br><strong>Relevance</strong>: Provides baseline performance and initial insight into linear relationships in the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Random Forest Regressor</strong></p></td>
<td><p>Ensemble of decision trees to improve accuracy and control overfitting.</p></td>
<td><p><strong>Advantages</strong>: Can handle linear and non-linear data; Less prone to overfitting; Robust to outliers.<br><strong>Disadvantages</strong>: Can be computationally expensive for large datasets.</p></td>
<td><p><strong>Why Chosen</strong>: Versatile and robust model.<br><strong>Relevance</strong>: Captures complex interactions and offers insight into feature importance, making it suitable for datasets with mixed features.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Gradient Boosting Regressor</strong></p></td>
<td><p>Boosting technique building trees sequentially, each correcting its predecessor’s errors.</p></td>
<td><p><strong>Advantages</strong>: High predictive accuracy; Can capture subtle patterns.<br><strong>Disadvantages</strong>: Requires careful tuning; More prone to overfitting with noisy data.</p></td>
<td><p><strong>Why Chosen</strong>: Known for high accuracy in various applications.<br><strong>Relevance</strong>: Suitable for capturing intricate patterns and relationships in the dataset when tuned correctly.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Support Vector Regression (SVR)</strong></p></td>
<td><p>Finds the best hyperplane to predict continuous values; Can handle high dimensional spaces.</p></td>
<td><p><strong>Advantages</strong>: Effective in high-dimensional spaces; Can model non-linear relationships.<br><strong>Disadvantages</strong>: Requires data scaling; Choice of kernel and parameters crucial.</p></td>
<td><p><strong>Why Chosen</strong>: Effective for potential non-linear relationships.<br><strong>Relevance</strong>: Given the diverse nature of the dataset, SVR can model non-linear patterns when using the appropriate kernel.</p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">### Use child_level_type</span>
<span class="sd">data_cleaned = df_model.dropna()</span>

<span class="sd"># Feature Engineering: Aggregate answer_correct_flag</span>
<span class="sd">aggregated_data = data_cleaned.groupby([&#39;teacher_user_id&#39;, &#39;course_name&#39;, &#39;school_year&#39;, </span>
<span class="sd">                                        &#39;parent_level_type&#39;, &#39;child_level_type&#39;, &#39;student_user_id&#39;])[&#39;answer_correct_flag&#39;].mean().reset_index()</span>
<span class="sd">aggregated_data.rename(columns={&#39;answer_correct_flag&#39;: &#39;avg_answer_correct&#39;}, inplace=True)</span>

<span class="sd"># Merging aggregated_data with data_cleaned</span>
<span class="sd">merged_data = pd.merge(aggregated_data, data_cleaned.drop(columns=[&#39;answer_correct_flag&#39;]), </span>
<span class="sd">                       on=[&#39;teacher_user_id&#39;, &#39;course_name&#39;, &#39;school_year&#39;, &#39;parent_level_type&#39;, </span>
<span class="sd">                           &#39;child_level_type&#39;, &#39;student_user_id&#39;], </span>
<span class="sd">                       how=&#39;left&#39;).drop_duplicates()</span>

<span class="sd"># Encode categorical variables</span>
<span class="sd">cols_to_drop = [&#39;teacher_user_id&#39;, &#39;course_name&#39;, &#39;school_year&#39;, &#39;parent_level_type&#39;, &#39;student_user_id&#39;, &#39;avg_answer_correct&#39;,&#39;difficulty_coefficient&#39;,&#39;Others&#39;]</span>
<span class="sd">merged_data_encoded = pd.get_dummies(merged_data.drop(columns=cols_to_drop), columns=[&#39;implementation_level&#39;, &#39;child_level_type&#39;], drop_first=True)</span>

<span class="sd">X = merged_data_encoded</span>
<span class="sd">y = merged_data[&#39;avg_answer_correct&#39;]</span>
<span class="sd">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">### Use child_level_type</span>
<span class="n">data_cleaned</span> <span class="o">=</span> <span class="n">df_model</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Feature Engineering: Aggregate answer_correct_flag</span>
<span class="n">aggregated_data</span> <span class="o">=</span> <span class="n">data_cleaned</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;course_name&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">,</span> 
                                        <span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span> <span class="s1">&#39;child_level_type&#39;</span><span class="p">,</span> <span class="s1">&#39;student_user_id&#39;</span><span class="p">])[</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">aggregated_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">:</span> <span class="s1">&#39;avg_answer_correct&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merging aggregated_data with data_cleaned</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">aggregated_data</span><span class="p">,</span> <span class="n">data_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;answer_correct_flag&#39;</span><span class="p">]),</span> 
                       <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;course_name&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span> 
                           <span class="s1">&#39;child_level_type&#39;</span><span class="p">,</span> <span class="s1">&#39;student_user_id&#39;</span><span class="p">],</span> 
                       <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Encode categorical variables</span>
<span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;teacher_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;course_name&#39;</span><span class="p">,</span> <span class="s1">&#39;school_year&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_level_type&#39;</span><span class="p">,</span> <span class="s1">&#39;student_user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_answer_correct&#39;</span><span class="p">,</span><span class="s1">&#39;difficulty_coefficient&#39;</span><span class="p">,</span><span class="s1">&#39;Others&#39;</span><span class="p">]</span>
<span class="n">merged_data_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">merged_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_to_drop</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;implementation_level&#39;</span><span class="p">,</span> <span class="s1">&#39;child_level_type&#39;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">merged_data_encoded</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;avg_answer_correct&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="model-performance">
<h3>Model Performance<a class="headerlink" href="#model-performance" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train regression models</span>
<span class="n">linear_reg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">rf_reg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">gbm_reg</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">svr_reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">linear_preds</span> <span class="o">=</span> <span class="n">linear_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rf_preds</span> <span class="o">=</span> <span class="n">rf_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">gbm_preds</span> <span class="o">=</span> <span class="n">gbm_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">svr_preds</span> <span class="o">=</span> <span class="n">svr_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">regression_metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">,</span> <span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span> <span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">,</span> <span class="s1">&#39;Support Vector Regression&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">linear_preds</span><span class="p">),</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_preds</span><span class="p">),</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">gbm_preds</span><span class="p">),</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svr_preds</span><span class="p">)],</span>
    <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">linear_preds</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_preds</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">gbm_preds</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svr_preds</span><span class="p">)],</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">linear_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">gbm_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svr_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)],</span>
    <span class="s1">&#39;R-squared&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">linear_preds</span><span class="p">),</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_preds</span><span class="p">),</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">gbm_preds</span><span class="p">),</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">svr_preds</span><span class="p">)]</span>
<span class="p">}</span>

<span class="n">performance_df_reg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">regression_metrics</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">performance_df_reg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>RMSE</th>
      <th>R-squared</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Linear Regression</td>
      <td>0.318498</td>
      <td>0.142456</td>
      <td>0.377434</td>
      <td>0.125300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest</td>
      <td>0.294017</td>
      <td>0.138522</td>
      <td>0.372186</td>
      <td>0.149455</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gradient Boosting</td>
      <td>0.294842</td>
      <td>0.129238</td>
      <td>0.359497</td>
      <td>0.206461</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Support Vector Regression</td>
      <td>0.269798</td>
      <td>0.128071</td>
      <td>0.357869</td>
      <td>0.213629</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple">
<li><p><strong>Support Vector Regression (SVR)</strong>: SVR has the <strong>lowest MAE, MSE, and RMSE</strong>, and the <strong>highest ( R^2 ) value</strong> among all the models, making it the best-performing model in this context.</p></li>
<li><p><strong>Gradient Boosting and Random Forest</strong>: These two models perform comparably, with Gradient Boosting having a slight edge in terms of <strong>RMSE and ( R^2 )</strong>.</p></li>
<li><p><strong>Linear Regression</strong>: This model has the <strong>weakest performance</strong> among the four models.</p></li>
</ol>
</section>
</section>
<section id="feature-importance-analysis">
<h2>Feature Importance Analysis<a class="headerlink" href="#feature-importance-analysis" title="Permalink to this heading">#</a></h2>
<p>Feature importance plots for Gradient Boosting and SVR are presetned since they are the two best-performaing models.</p>
<section id="feature-importance-plots">
<h3>Feature Importance Plots<a class="headerlink" href="#feature-importance-plots" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract feature importance for tree-based models</span>
<span class="n">rf_feature_importance</span> <span class="o">=</span> <span class="n">rf_reg</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="n">gbm_feature_importance</span> <span class="o">=</span> <span class="n">gbm_reg</span><span class="o">.</span><span class="n">feature_importances_</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">feature_importance_comparison_df = pd.DataFrame({</span>
<span class="sd">    &#39;Feature&#39;: X_train.columns,</span>
<span class="sd">    &#39;Random Forest Importance&#39;: rf_feature_importance,</span>
<span class="sd">    &#39;Gradient Boosting Importance&#39;: gbm_feature_importance</span>
<span class="sd">})</span>

<span class="sd">feature_importance_comparison_df = feature_importance_comparison_df.sort_values(by=&#39;Gradient Boosting Importance&#39;, ascending=False)</span>

<span class="sd">feature_importance_comparison_df</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">perm_importance</span> <span class="o">=</span> <span class="n">permutation_importance</span><span class="p">(</span><span class="n">svr_reg</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">perm_importance</span><span class="o">.</span><span class="n">importances_mean</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize feature importance for Gradient Boosting Regressor</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sorted_idx_gbr</span> <span class="o">=</span> <span class="n">gbm_feature_importance</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sorted_idx_gbr</span><span class="p">],</span> <span class="n">gbm_feature_importance</span><span class="p">[</span><span class="n">sorted_idx_gbr</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature Importance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Importance via Gradient Boosting Regressor&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">],</span> <span class="n">perm_importance</span><span class="o">.</span><span class="n">importances_mean</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Permutation Importance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Importance via Permutation for RBF SVM&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d789e427fed385913b8b1505fddd88dca72b9cfba7aae4d085fdd0f0a8b67dcc.png" src="../../_images/d789e427fed385913b8b1505fddd88dca72b9cfba7aae4d085fdd0f0a8b67dcc.png" />
</div>
</div>
</section>
<section id="visualizing-gradient-boosting-importance-shap">
<h3>Visualizing Gradient Boosting Importance: SHAP<a class="headerlink" href="#visualizing-gradient-boosting-importance-shap" title="Permalink to this heading">#</a></h3>
<p>SHAP (SHapley Additive exPlanations) values provide a unified measure of feature importance and effects, taking into account the interaction effects among features. It gives a value for each feature for each prediction, indicating the direction and magnitude of the feature’s effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute SHAP values for Gradient Boosting Regressor</span>
<span class="n">explainer_gbm</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">TreeExplainer</span><span class="p">(</span><span class="n">gbm_reg</span><span class="p">)</span>
<span class="n">shap_values_gbm</span> <span class="o">=</span> <span class="n">explainer_gbm</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">shap_values_gbm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.00246   , -0.07297301,  0.00959309, ..., -0.03896769,
         0.01029837,  0.0070149 ],
       [-0.00348033, -0.01293709,  0.01283022, ..., -0.06985797,
        -0.10261283, -0.10205683],
       [-0.00348033, -0.01670614, -0.00130648, ..., -0.04115582,
         0.01350352,  0.00995538],
       ...,
       [-0.00246   , -0.00468932,  0.01289146, ..., -0.05215143,
         0.01204603,  0.00890268],
       [-0.00296803, -0.0086628 ,  0.01064341, ..., -0.05749316,
         0.01273758,  0.01035887],
       [ 0.00157379, -0.03418947, -0.04781907, ..., -0.04972869,
         0.01171637,  0.00649308]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values_gbm</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a174ac951c1cd2d81e7f20583e6584065d633c18712783cbb9a9ec33fbc4ce35.png" src="../../_images/a174ac951c1cd2d81e7f20583e6584065d633c18712783cbb9a9ec33fbc4ce35.png" />
</div>
</div>
<p><strong>Vertical Axis</strong>: Each row on the y-axis corresponds to a feature in the dataset.
Features at the top are the most influential, with significance decreasing as you move downwards.</p>
<p><strong>Horizontal Axis</strong>: Represents the SHAP value for each feature. The further a dot is from the center, the greater its impact on the prediction.
Right of Center (positive values): Features that push the prediction higher.
Left of Center (negative values): Features that push the prediction lower.</p>
<p><strong>Color</strong>: The color intensity signifies the magnitude of the feature value.
Red Dots: High feature values. For example, <u> red dots on the right suggests that high values of this feature increase the assessment scores </u>.
Blue Dots: Low feature values. For example, <u> blue dots on the right suggests that low values of this feature increase the assessment scores </u>.</p>
<p>A mix of red and blue dots spread across both sides indicates that the feature can either increase or decrease the prediction, depending on its value and potential interactions with other features. For instance, both very high and very low values of a feature might increase the prediction, while mid-range values decrease it.</p>
</section>
<section id="visualizing-svm-importance-partial-dependence-plots">
<h3>Visualizing SVM Importance: Partial Dependence Plots<a class="headerlink" href="#visualizing-svm-importance-partial-dependence-plots" title="Permalink to this heading">#</a></h3>
<p>These plots show the relationship between a feature and the predicted outcome while keeping all other features constant. They provide insight into the direction and strength of the relationship between the features and the prediction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">PartialDependenceDisplay</span>

<span class="c1"># Generate the partial dependence display object with the 3x2 layout for the top 6 important features</span>
<span class="n">top_features</span> <span class="o">=</span> <span class="n">sorted_idx</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span>
<span class="c1"># Reverse the order of the top_features list</span>
<span class="n">top_features</span> <span class="o">=</span> <span class="n">top_features</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">display</span> <span class="o">=</span> <span class="n">PartialDependenceDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span><span class="n">svr_reg</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">top_features</span><span class="p">,</span> <span class="n">grid_resolution</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9256902ca0a3f0dd730db08231baff9ae84acd9c35883a7f83d23d0f9afb18d0.png" src="../../_images/9256902ca0a3f0dd730db08231baff9ae84acd9c35883a7f83d23d0f9afb18d0.png" />
</div>
</div>
<p><strong>Flat Line</strong>:
Indicates the feature has little to no effect on the prediction when other variables are held constant.</p>
<p><strong>Sloping Line (Upward/Downward)</strong>:
Indicates a positive/negative relationship between the feature and the outcome.
Positive Slope: As the feature’s value increases, the predicted outcome also increases.
Negative Slope: As the feature’s value increases, the predicted outcome decreases.</p>
<p><strong>Curved Line</strong>:
Indicates a non-linear relationship. The feature might have increasing effects up to a point and decreasing effects afterward, or vice-versa.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Insights</p>
<ol class="arabic simple">
<li><p><strong>Dominance of Question Types</strong>:</p>
<ul class="simple">
<li><p>The predominant role of question types is evident, with ‘matching’ and ‘single choice’ emerging as strong positive predictors of scores. This aligns with finding from assessment section where matching question is the easiest type of question, followed by single-choice question.</p></li>
</ul>
</li>
<li><p><strong>Student Learning Profiles Matter</strong>:</p>
<ul class="simple">
<li><p>Beyond the inherent question type, it’s evident that a student’s daily activity engagement patterns can predict their assessment scores. The profiles ‘reflective learner’ and ‘succeed at first trial’ are positively associated with assessment scores. This underscores the value of consistent engagement and the ability to grasp concepts quickly.</p></li>
</ul>
</li>
<li><p><strong>Concerning Learning Patterns</strong>:</p>
<ul class="simple">
<li><p>In contrast, the ‘struggler’ profile negatively correlates with performance, indicating that persistent challenges grasping material associate with poorer outcomes. Targeted support may help remediate these learner needs.</p></li>
</ul>
</li>
<li><p><strong>Potential Misconceptions Addressed</strong>:</p>
<ul class="simple">
<li><p>Interestingly, patterns like ‘one-shot failure’ and ‘rapid guessing’ don’t show a significant association with assessment scores in the SVM model. Rapid guessing and one-shot failures, often seen as red flags, might not always signify poor understanding or performance. It’s possible that in some contexts, these patterns might represent a strategic approach to learning or testing. Further investigation is needed to explore the nuances of these behaviors.</p></li>
</ul>
</li>
</ol>
</div>
</section>
<section id="key-insights">
<h2>Key Insights:<a class="headerlink" href="#key-insights" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Re-examining Question Design</strong>:</p>
<ul>
<li><p>The strong influence of certain question types signals the need to carefully evaluate assessment question design. Educators should ensure assessments include a strategic mix of question types that avoids potential biases and accurately measures comprehension of learning objectives.</p></li>
</ul>
</li>
<li><p><strong>Teacher Development</strong>:</p>
<ul>
<li><p>Training on strategies to recognize learning profiles, personalize instruction, design objective assessments, and avoid biased evaluations based on assumptions could empower teachers. This suggests the need for nuanced approaches to assess and categorize learners’ behaviors.</p></li>
</ul>
</li>
<li><p><strong>Personalized Learning Interventions</strong>:</p>
<ul>
<li><p>Recognizing the distinct learning profiles and their influence on assessments can lead to more personalized and effective learning interventions. For instance, providing additional resources or tailored learning pathways for ‘strugglers’ could enhance their understanding and performance. Providing targeted support, resources, and interventions based on each student’s learning patterns could help struggling students while optimizing outcomes for all.</p></li>
</ul>
</li>
<li><p><strong>Challenging Traditional Notions</strong>:</p>
<ul>
<li><p>The lack of significant association between certain patterns (like rapid guessing) and assessment scores underscores the importance of not hastily categorizing students based on isolated behaviors.</p></li>
</ul>
</li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/jupyter_execute"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teacher-implementation-level-clustering">Teacher Implementation Level Clustering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-type-and-teacher-experience-features">Question Type and Teacher Experience Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#student-learning-behavior-features">Student Learning Behavior Features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-training-and-evaluation">Model Training and Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-performance">Model Performance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-analysis">Feature Importance Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-plots">Feature Importance Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-gradient-boosting-importance-shap">Visualizing Gradient Boosting Importance: SHAP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-svm-importance-partial-dependence-plots">Visualizing SVM Importance: Partial Dependence Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights:</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>